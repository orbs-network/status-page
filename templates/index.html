<!DOCTYPE html>
<html>
<head>
    <title>Status page</title>
    <style>
        body {
            font-family: 'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif
        }

        td {
            padding: 10px;
        }

        td a {
            color: aliceblue;
        }

        .green {
            background-color: seagreen;
        }

        .red {
            background-color: crimson;
        }

        html, body { margin: 0; padding: 0; }
        
        .centeredDiv { 
            margin-right: auto;
            margin-left: auto;
            width: <%= (_.size(vchains) + 1) * 150 %>px;
        }

        .centeredDiv table {
            width: 100%;
        }

        .node-name {
            font-size: 14pt;
        }
    </style>
</head>
<body>
    <div class="centeredDiv">
        <table>
            <tr>
                <td><!-- empty space --></td>
                <% _.forEach(vchains, (vcid) => {%>
                    <td>vc<%= vcid %></td>
                <% }) %>
            </tr>
        
            <% _.forEach(_.keys(state), (node) => {%>
            <tr>
                <td class="node-name"><%= node %></td>
                <% _.forEach(vchains, (vcid) => {
                    const data = _.get(state, `${node}.${vcid}`);
                    const { blockHeight, status, version, commit } = data;
                    const shortCommit = !_.isEmpty(commit) ? commit.substring(0, 8) : "";
                    const githubLink = `https://github.com/orbs-network/orbs-network-go/commit/${shortCommit}`;
                    const metricsLink = `http://${getEndpoint(ips[node], vcid)}/metrics`;
                %>
                    <td class="<%= status %>">
                        <% if (!data || _.isEmpty(data) || (!version && blockHeight == 0)) { %> 
                            <a href="<%= metricsLink %>">no data</a>
                        <% } else { %>
                            <a href="<%= metricsLink %>"><%= blockHeight %></a>
                            <br/><%= version %><br/>
                            <a href="<%= githubLink %>"><%= shortCommit %></a>
                        <% } %>
                    </td>
                <% }) %>
            </tr>
            <% }) %>    
        </table>                
    </div>
</body>
</html>
